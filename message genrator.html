<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PTM Message Generator</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Configure Tailwind to use the Inter font (or system fallback) -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        /* Using Noto Sans for Marathi support */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;700&display=swap');
        body {
            font-family: 'Inter', 'Noto Sans', sans-serif;
            background-color: #f7f9fb;
        }
        .message-box {
            white-space: pre-wrap; /* Preserve formatting and line breaks */
            line-height: 1.6;
        }
    </style>
</head>
<body class="p-4 md:p-8 min-h-screen flex items-center justify-center">

    <div class="w-full max-w-4xl bg-white shadow-2xl rounded-xl p-6 md:p-10 border border-gray-100">
        <h1 class="text-3xl font-extrabold text-gray-800 mb-2">PTM Invitation Message Tool</h1>
        <p class="text-gray-500 mb-8">Customize the details to generate, copy, and send the message instantly in English and Marathi.</p>

        <!-- Input Controls Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
            
            <!-- Student Name -->
            <div class="md:col-span-2">
                <label for="student-name-input" class="block text-sm font-medium text-gray-700 mb-1">Student Name</label>
                <input type="text" id="student-name-input" placeholder="Aarohi" value="Aarohi"
                        class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition duration-150 ease-in-out shadow-sm text-gray-800">
            </div>

            <!-- Date Picker -->
            <div>
                <label for="date-input" class="block text-sm font-medium text-gray-700 mb-1">Select Date</label>
                <input type="date" id="date-input" 
                        class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition duration-150 ease-in-out shadow-sm text-gray-800">
            </div>
            
            <!-- Time Picker -->
            <div>
                <label for="time-input" class="block text-sm font-medium text-gray-700 mb-1">Select Time</label>
                <input type="time" id="time-input" 
                        class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition duration-150 ease-in-out shadow-sm text-gray-800">
            </div>
            
            <!-- Primary WhatsApp Number Input -->
            <div>
                <label for="phone-input" class="block text-sm font-medium text-gray-700 mb-1">Primary WhatsApp Number (e.g., 9876543210)</label>
                <input type="tel" id="phone-input" placeholder="10-digit mobile number"
                        class="w-full p-3 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500 transition duration-150 ease-in-out shadow-sm text-gray-800">
            </div>

            <!-- Extra WhatsApp Number Input -->
            <div>
                <label for="extra-phone-input" class="block text-sm font-medium text-gray-700 mb-1">Extra WhatsApp Number (Optional)</label>
                <input type="tel" id="extra-phone-input" placeholder="Optional secondary number"
                        class="w-full p-3 border border-gray-300 rounded-lg focus:ring-teal-500 focus:border-teal-500 transition duration-150 ease-in-out shadow-sm text-gray-800">
            </div>
        </div>

        <!-- Generated Message Output -->
        <div class="mb-6">
            <label class="block text-sm font-medium text-gray-700 mb-2">Generated Invitation Message</label>
            <div id="message-output" 
                 class="message-box bg-gray-50 p-4 border border-gray-200 rounded-lg text-gray-700 min-h-[120px]">
                Please enter the student's name, select a date, and time.
            </div>
        </div>

        <!-- Action Buttons (Copy and WhatsApp Send) -->
        <div class="flex flex-col sm:flex-row justify-end gap-4">
            
            <!-- Copy Button -->
            <button id="copy-button" 
                    class="px-6 py-3 bg-indigo-600 text-white font-semibold rounded-lg shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition duration-150 ease-in-out disabled:opacity-50"
                    disabled>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline mr-2" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M7 9a2 2 0 012-2h6a2 2 0 012 2v6a2 2 0 01-2 2H9a2 2 0 01-2-2V9z" />
                    <path d="M5 3a2 2 0 00-2 2v6a2 2 0 002 2V5h4a2 2 0 00-2-2H5z" />
                </svg>
                Copy Message
            </button>
            
            <!-- Send via Primary WhatsApp Button -->
            <button id="whatsapp-button-primary" 
                    class="order-first sm:order-last px-6 py-3 bg-green-600 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition duration-150 ease-in-out disabled:opacity-50"
                    disabled>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline mr-2" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12.04 2C6.54 2 2.08 6.46 2.08 11.96c0 1.76.46 3.42 1.3 4.88L2 22l5.24-1.37c1.39.77 2.97 1.2 4.8 1.2 5.5 0 9.97-4.46 9.97-9.96S17.54 2 12.04 2zm3.33 13.93c-.09.23-.31.28-.56.12l-1.92-.93c-.22-.11-.49-.1-.73.04l-1.16 1.15c-.32.32-.82.17-1.15-.15-.71-.7-1.32-1.48-1.84-2.31-.56-.88-.93-1.87-1.07-2.92-.04-.26.1-.53.33-.66l1.92-1.07c.25-.14.39-.42.3-.67l-.23-.62c-.12-.32-.42-.51-.76-.51H8.09c-.31 0-.61.16-.79.43L6.37 9.87c-.63 1.05-.72 2.37.04 3.7.83 1.48 2.05 2.7 3.53 3.53 1.32.74 2.65.62 3.7.04l1.17-1.29c.17-.2.27-.45.27-.72 0-.32-.17-.6-.43-.76z"/>
                </svg>
                Send (Primary)
            </button>
            
            <!-- Send via Extra WhatsApp Button -->
            <button id="whatsapp-button-extra" 
                    class="order-last px-6 py-3 bg-teal-600 text-white font-semibold rounded-lg shadow-md hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2 transition duration-150 ease-in-out disabled:opacity-50"
                    disabled>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline mr-2" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12.04 2C6.54 2 2.08 6.46 2.08 11.96c0 1.76.46 3.42 1.3 4.88L2 22l5.24-1.37c1.39.77 2.97 1.2 4.8 1.2 5.5 0 9.97-4.46 9.97-9.96S17.54 2 12.04 2zm3.33 13.93c-.09.23-.31.28-.56.12l-1.92-.93c-.22-.11-.49-.1-.73.04l-1.16 1.15c-.32.32-.82.17-1.15-.15-.71-.7-1.32-1.48-1.84-2.31-.56-.88-.93-1.87-1.07-2.92-.04-.26.1-.53.33-.66l1.92-1.07c.25-.14.39-.42.3-.67l-.23-.62c-.12-.32-.42-.51-.76-.51H8.09c-.31 0-.61.16-.79.43L6.37 9.87c-.63 1.05-.72 2.37.04 3.7.83 1.48 2.05 2.7 3.53 3.53 1.32.74 2.65.62 3.7.04l1.17-1.29c.17-.2.27-.45.27-.72 0-.32-.17-.6-.43-.76z"/>
                </svg>
                Send (Extra)
            </button>
        </div>

        <!-- Status Message (for copying/sending) -->
        <div id="status-message" class="mt-4 text-center text-sm text-green-600 opacity-0 transition-opacity duration-300"></div>

    </div>

    <script>
        // DOM Elements
        const studentNameInput = document.getElementById('student-name-input');
        const dateInput = document.getElementById('date-input');
        const timeInput = document.getElementById('time-input');
        const phoneInput = document.getElementById('phone-input');
        const extraPhoneInput = document.getElementById('extra-phone-input');
        const messageOutput = document.getElementById('message-output');
        const copyButton = document.getElementById('copy-button');
        const whatsappButtonPrimary = document.getElementById('whatsapp-button-primary');
        const whatsappButtonExtra = document.getElementById('whatsapp-button-extra');
        const statusMessage = document.getElementById('status-message');

        // --- Message Templates ---

        // 1. English Template
        const ENGLISH_TEMPLATE = `Dear parent of *{STUDENT_NAME}*

*Allen Career Institute Latur - PNCF* Division is happy to welcome you to a *Mentors meet* session this Sunday.

Date: {DATE}
Time: {TIME}

*Agenda:* How to overcome the anxiety and maintain discipline in last 3 months to achieve best result.

Hoping to see you at _Allen Laxmi Landmark_ campus this Sunday!

Regards,
DAMINI PIMPALSHENDE
PNCF - BIOLOGY Faculty
*Allen Career Institute, Latur*`;

        // 2. Marathi Template (updated with placeholders)
        const MARATHI_TEMPLATE = `
---
नमस्कार, मी दमिनी मॅडम, FNN-3 बॅचची मेंटर बोलते आहे. येणाऱ्या मेंटर्स मीटसाठी आपणास आमंत्रित करण्यासाठी हा संदेश आहे.

आदरणीय *{STUDENT_NAME}* यांच्या पालकांना,

Allen Career Institute, Latur – PNCF Division तर्फे या रविवारच्या *मेंटर्स मीट* साठी आपले मनःपूर्वक स्वागत आहे.

दिनांक: {MARATHI_DATE}
वेळ: {MARATHI_TIME}

विषय: पुढील ३ महिन्यांत चिंता कशी कमी करायची आणि उत्तम निकालासाठी शिस्त कशी टिकवायची.

आपली उपस्थिती Allen Laxmi Landmark कॅम्पसवर राहावी, ही विनंती.

आपली,
दमिनी पिंपळशेंडे
PNCF – बायोलॉजी फॅकल्टी
Allen Career Institute, Latur`;

        // --- Formatting Functions ---

        // Function to format the date string (YYYY-MM-DD) into a readable English format
        function formatReadableDate(dateString) {
            if (!dateString) return null;
            try {
                // Append T00:00:00 to avoid timezone issues during parsing
                const date = new Date(dateString + 'T00:00:00'); 
                return new Intl.DateTimeFormat('en-US', { 
                    weekday: 'long', 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                }).format(date);
            } catch (e) {
                console.error("English Date formatting error:", e);
                return dateString;
            }
        }

        // Function to format the time string (HH:MM) into 12-hour format (e.g., 11:00 AM)
        function formatReadableTime(timeString) {
            if (!timeString) return null;
            try {
                const [hours, minutes] = timeString.split(':');
                const date = new Date();
                date.setHours(parseInt(hours, 10), parseInt(minutes, 10));

                return new Intl.DateTimeFormat('en-US', { 
                    hour: 'numeric', 
                    minute: '2-digit', 
                    hour12: true 
                }).format(date);
            } catch (e) {
                console.error("English Time formatting error:", e);
                return timeString;
            }
        }

        // Function to format the date/time string into Marathi format
        function formatMarathiDateTime(dateString, timeString) {
            if (!dateString || !timeString) return { date: null, time: null };

            try {
                // 1. Prepare Date object using date and time for correct formatting context
                const [year, month, day] = dateString.split('-').map(Number);
                const [hours, minutes] = timeString.split(':').map(Number);
                const date = new Date(year, month - 1, day, hours, minutes);

                // 2. Marathi Date Format: रविवार, ७ डिसेंबर २०२५
                const marathiDate = new Intl.DateTimeFormat('mr-IN', {
                    weekday: 'long',
                    day: 'numeric',
                    month: 'long',
                    year: 'numeric'
                }).format(date);

                // 3. Marathi Time Format: सकाळी ११:०० वा. (or संध्याकाळी)
                const isAM = hours < 12;
                const marathiTime = new Intl.DateTimeFormat('mr-IN', {
                    hour: 'numeric',
                    minute: '2-digit',
                    hour12: true,
                    // Use a 24-hour time string but add "वा." manually or rely on locale-specific markers if available
                }).format(date);
                
                // Manually prepend सकाळ/संध्याकाळ and append वा. to ensure consistency
                const timePrefix = isAM ? 'सकाळी' : 'संध्याकाळी';
                const finalTime = `${timePrefix} ${marathiTime.replace(/\s(am|pm)/i, '').trim()} वा.`;


                return { date: marathiDate, time: finalTime };

            } catch (e) {
                console.error("Marathi formatting error:", e);
                return { date: dateString, time: timeString };
            }
        }


        // Function to generate and update the message
        function generateMessage() {
            const nameValue = studentNameInput.value.trim() || 'Aarohi';
            const dateValue = dateInput.value;
            const timeValue = timeInput.value;
            const phoneValue = phoneInput.value.trim();
            const extraPhoneValue = extraPhoneInput.value.trim();
            
            const formattedDate = formatReadableDate(dateValue);
            const formattedTime = formatReadableTime(timeValue);
            const marathiFormats = formatMarathiDateTime(dateValue, timeValue);
            
            let isMessageReady = false;
            let finalMessage = "Please enter the student's name, select a date, and time.";

            if (nameValue && formattedDate && formattedTime && marathiFormats.date && marathiFormats.time) {
                // 1. Generate English Message
                const englishMessage = ENGLISH_TEMPLATE
                    .replace('{STUDENT_NAME}', nameValue)
                    .replace('{DATE}', formattedDate)
                    .replace('{TIME}', formattedTime);
                
                // 2. Generate Marathi Message
                const marathiMessage = MARATHI_TEMPLATE
                    .replace('{STUDENT_NAME}', nameValue)
                    .replace('{MARATHI_DATE}', marathiFormats.date)
                    .replace('{MARATHI_TIME}', marathiFormats.time);

                // 3. Combine them
                finalMessage = englishMessage + marathiMessage;
                
                isMessageReady = true;
            }

            messageOutput.textContent = finalMessage;

            // Check if essential fields are ready
            const isEssentialReady = isMessageReady;
            
            // Check readiness for WhatsApp buttons
            const isPhoneNumberValid = (number) => number.replace(/[^0-9]/g, '').length >= 10;
            
            const whatsappPrimaryReady = isEssentialReady && isPhoneNumberValid(phoneValue);
            const whatsappExtraReady = isEssentialReady && isPhoneNumberValid(extraPhoneValue);


            // Enable/Disable buttons based on readiness
            copyButton.disabled = !isEssentialReady;
            copyButton.classList.toggle('disabled:opacity-50', !isEssentialReady);
            
            whatsappButtonPrimary.disabled = !whatsappPrimaryReady;
            whatsappButtonPrimary.classList.toggle('disabled:opacity-50', !whatsappPrimaryReady);

            whatsappButtonExtra.disabled = !whatsappExtraReady;
            whatsappButtonExtra.classList.toggle('disabled:opacity-50', !whatsappExtraReady);
        }

        // Function to handle copying the message
        function copyMessage() {
            const textToCopy = messageOutput.textContent;
            
            const tempTextarea = document.createElement('textarea');
            tempTextarea.value = textToCopy;
            document.body.appendChild(tempTextarea);
            tempTextarea.select();
            
            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    statusMessage.textContent = 'Message copied to clipboard!';
                    statusMessage.classList.remove('opacity-0', 'text-red-600');
                    statusMessage.classList.add('text-green-600');
                    setTimeout(() => {
                        statusMessage.classList.add('opacity-0');
                    }, 2000);
                } else {
                    console.error('Copying failed.');
                    statusMessage.textContent = 'Copying failed. Please copy manually.';
                    statusMessage.classList.remove('opacity-0', 'text-green-600');
                    statusMessage.classList.add('text-red-600');
                    setTimeout(() => {
                        statusMessage.classList.add('opacity-0');
                        statusMessage.classList.remove('text-red-600');
                    }, 3000);
                }
            } catch (err) {
                console.error('Could not copy text: ', err);
                statusMessage.textContent = 'Copying failed. Please copy manually.';
                statusMessage.classList.remove('opacity-0', 'text-green-600');
                statusMessage.classList.add('text-red-600');
                setTimeout(() => {
                    statusMessage.classList.add('opacity-0');
                    statusMessage.classList.remove('text-red-600');
                }, 3000);
            }
            
            document.body.removeChild(tempTextarea);
        }
        
        // Function to sanitize phone number and ensure +91 country code for Indian numbers
        function sanitizePhoneNumber(inputElement) {
            const rawNumber = inputElement.value.replace(/[^0-9]/g, '');
            // Check if it's a 10-digit number (standard Indian mobile format without CC)
            if (rawNumber.length === 10) {
                return '91' + rawNumber; // Prepend 91
            }
            // Check if it's 12 digits (already includes 91) or longer (already includes CC)
            if (rawNumber.length >= 12 && rawNumber.startsWith('91')) {
                return rawNumber;
            }
            // Otherwise, return the raw number (e.g., if it's not an Indian number or is an invalid length)
            return rawNumber;
        }

        // Function to handle sending WhatsApp message to a specific number field
        function sendWhatsAppMessage(phoneNumberElement, statusText) {
            // Get the sanitized number (guaranteed to include '91' for 10-digit inputs)
            const phoneNumber = sanitizePhoneNumber(phoneNumberElement);
            const message = messageOutput.textContent;
            
            if (phoneNumber.length < 10 || !message) {
                statusMessage.textContent = `Error: Cannot send. Invalid ${statusText} or message is missing.`;
                statusMessage.classList.remove('opacity-0', 'text-green-600');
                statusMessage.classList.add('text-red-600');
                setTimeout(() => {
                    statusMessage.classList.add('opacity-0');
                    statusMessage.classList.remove('text-red-600');
                }, 3000);
                return;
            }

            const encodedMessage = encodeURIComponent(message);
            // wa.me requires the number without the leading '+'
            const whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodedMessage}`;

            window.open(whatsappUrl, '_blank');
            
            statusMessage.textContent = `Opening WhatsApp link for ${statusText} (${phoneNumber})...`;
            statusMessage.classList.remove('opacity-0', 'text-red-600');
            statusMessage.classList.add('text-green-600');
            setTimeout(() => {
                statusMessage.classList.add('opacity-0');
            }, 2000);
        }

        // Event Listeners for all inputs to regenerate the message
        studentNameInput.addEventListener('input', generateMessage);
        dateInput.addEventListener('change', generateMessage);
        timeInput.addEventListener('change', generateMessage);
        phoneInput.addEventListener('input', generateMessage);
        extraPhoneInput.addEventListener('input', generateMessage);
        
        copyButton.addEventListener('click', copyMessage);
        
        // Primary WhatsApp Button handler
        whatsappButtonPrimary.addEventListener('click', () => {
            sendWhatsAppMessage(phoneInput, 'Primary Number');
        }); 
        
        // Extra WhatsApp Button handler
        whatsappButtonExtra.addEventListener('click', () => {
            sendWhatsAppMessage(extraPhoneInput, 'Extra Number');
        }); 

        // Initial call to set the placeholder message on load
        window.onload = generateMessage;

    </script>
</body>
</html>
